@use "./root.scss" as *;
@use "./mixins.scss" as *;
@use "./colors.scss" as color;
@use "sass:color" as sassColor;

/* # Smooth transitions for layout changes */
@if $enablePanelTransitions {
   .monaco-grid-view>div>div>div.monaco-scrollable-element>div.split-view-container>div:nth-child(3)>div>div>div.monaco-scrollable-element>div.split-view-container>div:nth-child(3)>div>div>div.monaco-scrollable-element>div.split-view-container>div:nth-child(2) {
      transition: top var(--perfume-transition), bottom var(--perfume-transition) !important;
   }
}

@if $enablePanelTransitions {
   .monaco-grid-branch-node>*>*>.split-view-container>.split-view-view {
      transition: (top var(--perfume-transition), bottom var(--perfume-transition)) !important;
   }
}

/* Tooltips */
.context-view.monaco-component > * > * {
	@include glass(true);
}

/* Title bar */
.part.titlebar {
	background: color-mix(in srgb, var(--perfume-bg), transparent 60%) !important;
}

/* Activity bar refinement */
.monaco-workbench .activitybar {
   background: linear-gradient(
      160deg,
      var(--perfume-bg-elev) 0%,
      var(--perfume-bg) 80%
   ) !important;
   border-right: 1px solid var(--perfume-border) !important;
}

/* Tabs glass & accent indicator */
.monaco-workbench .tabs-container>.tab.sizing-fit {
	backdrop-filter: blur(var(--perfume-blur-sm)) !important;
	overflow: hidden !important;
	margin-right: 2px !important;
}

.monaco-workbench .tabs-container>.tab.active {
	--tab-border-top-color: unset !important;

   background: linear-gradient(0deg, #2f2d3a 0%, #26232f 100%) !important;
   box-shadow: 0 2px 6px -2px var(--perfume-shadow-color),
      inset 0 0 0 1px var(--perfume-border) !important;
}

.monaco-workbench .tabs-container > .tab.active:before {
   content: "";
   position: absolute;
   inset: 0;
   pointer-events: none;
   background: radial-gradient(
      circle at 50% 10%,
      rgba(var(--perfume-accent-glow), 0.4),
      transparent 70%
   );
}

.monaco-workbench .tabs-container > .tab.active:after {
   content: "";
   position: absolute;
   left: 0;
   right: 0;
   bottom: 0;
   height: 2px;
   background: twotoneStrongBackground(90deg, 0%, 70%);
}

/* Sidebar section headers */
.monaco-workbench .composite.title {
   background: linear-gradient(90deg, #2a2834aa, #2f2d3a55) !important;
   border-bottom: 1px solid var(--perfume-border) !important;
   backdrop-filter: blur(var(--perfume-blur-sm)) !important;
}

/* Command palette */
.quick-input-widget {
   @include glass(false);
   @include glassBorder();
   box-shadow: 0 8px 32px -12px var(--perfume-shadow-color),
      0 0 0 1px rgba(255, 255, 255, 0.04) !important;
}

.quick-input-widget .monaco-list-row.focused {
   background: twotoneBackground() !important;
   box-shadow: inset 0 0 0 1px var(--perfume-accent) !important;
}

/* Hover & suggest widgets */
.monaco-editor .monaco-hover,
.editor-widget.suggest-widget,
.editor-widget.parameter-hints-widget,
.token-inspect-widget {
   @include glass(true);
   @include glassBorder();
}

.monaco-resizable-hover {
   border-radius: var(--perfume-radius-sm) !important;
}

.editor-widget.suggest-widget .monaco-list-row.focused {
   background: twotoneBackground() !important;
}

.context-view.monaco-component .monaco-scrollable-element {
   @include glass(true);
}

/* Menubar Items */
.monaco-menu-container .monaco-scrollable-element,
.menubar-menu-items-holder {
   @include glass(true);
   @include glassBorder();
   overflow: visible !important;

   & .monaco-menu {
      overflow: visible !important;
   }
}
.menubar-menu-items-holder .monaco-submenu > * {
   @include glass(true);
   @include glassBorder();

   // FIXME: Since backdrop-filter doesn't work on overflow children a temp fix is to apply a solid bg for now
   background: var(--perfume-bg-overlay) !important;
}

.menubar-menu-items-holder > * {
   background: transparent !important;
}

/* Command Palette panel (.quick-input-widget) */
.quick-input-widget {
   @include glass(true);
   @include glassBorder();
}

.quick-input-widget .monaco-list-rows {
   background: transparent !important;
}

/* Scrollbars subtle */
::-webkit-scrollbar {
   width: 10px !important;
   height: 10px !important;
}

::-webkit-scrollbar-track {
   background: transparent !important;
}

::-webkit-scrollbar-thumb {
   background: linear-gradient(180deg, #3a3744, #4a4755) !important;
   border-radius: 20px !important;
   border: 2px solid #23212d !important;
}

::-webkit-scrollbar-thumb:hover {
   background: linear-gradient(180deg, #4a4755, #5a5666) !important;
}

/* Status bar glass */
.monaco-workbench .part.statusbar {
   background: linear-gradient(
      90deg,
      #2a2834cc 60%,
      var(--perfume-accent-alt-tr)
   ) !important;
   box-shadow: 0 -1px 0 0 var(--perfume-border) inset,
      0 -4px 12px -6px rgba(0, 0, 0, 0.6) !important;
}

.part.statusbar .statusbar-item:nth-child(2) {
   background: transparent !important;
}

.part.statusbar .statusbar-item[aria-label*="master"]:nth-child(2),
.part.statusbar .statusbar-item[aria-label*="main"]:nth-child(2) {
   @include gitBranchIndicator(var(--perfume-accent));
}

.part.statusbar .statusbar-item[aria-label*="dev"]:nth-child(2) {
   @include gitBranchIndicator(var(--perfume-accent-alt));
}

.part.statusbar .statusbar-item[aria-label*="feat"]:nth-child(2) {
   @include gitBranchIndicator(#ff8c00);
}

.part.statusbar .statusbar-item[aria-label*="release"]:nth-child(2) {
   @include gitBranchIndicator(#8713c5);
}

.part.statusbar .statusbar-item[aria-label*="fix"]:nth-child(2) {
   @include gitBranchIndicator(#80db2b);
}

/* Buttons refinement */
.monaco-workbench .monaco-button:not(.toggle-replace-button),
.monaco-text-button {
   border-radius: var(--perfume-radius-sm) !important;
   letter-spacing: 0.5px !important;
   font-weight: 600 !important;
   position: relative !important;
   overflow: hidden !important;
}

.monaco-workbench .monaco-button.primary,
.monaco-text-button.primary {
   background: linear-gradient(140deg, #df1b6c, #ff4d96) !important;
   box-shadow: 0 4px 18px -8px rgba(var(--perfume-accent-glow), 0.6) !important;
}

.monaco-workbench .monaco-button.primary:hover {
   filter: brightness(1.08) saturate(1.15) !important;
}

.monaco-button-dropdown .monaco-button:not(:first-child),
.monaco-text-button-dropdown .monaco-button:not(:first-child) {
   border-top-left-radius: 0 !important;
   border-bottom-left-radius: 0 !important;
}

.monaco-button-dropdown .monaco-button:not(:last-child),
.monaco-text-button-dropdown .monaco-button:not(:last-child) {
   border-top-right-radius: 0 !important;
   border-bottom-right-radius: 0 !important;
}

/* Input fields */
.monaco-inputbox {
   background: #2a2834aa !important;
   border: 1px solid var(--perfume-border) !important;
   border-radius: var(--perfume-radius-sm) !important;
   backdrop-filter: blur(var(--perfume-blur-sm)) !important;
   transition: var(--perfume-transition) !important;
}

/* Inline code / token subtle rounding in markdown preview */
.markdown-body code {
   background: #2f2d3a;
   padding: 2px 6px;
   border-radius: var(--perfume-radius-sm);
   border: 1px solid #3a3744;
   color: var(--perfume-accent-alt);
}

/* Panel headers */
.monaco-workbench .panel .title {
   background: linear-gradient(90deg, #2f2d3a80, #23212d44) !important;
   backdrop-filter: blur(var(--perfume-blur-sm)) !important;
   border-bottom: 1px solid var(--perfume-border) !important;
}

/* Git decorations subtle underline instead of strong color backgrounds */
.monaco-editor .dirty-diff-added {
   background: linear-gradient(90deg, #2bb4af55, #2bb4af11) !important;
}

.monaco-editor .dirty-diff-modified {
   background: linear-gradient(90deg, #ffcf6b55, #ffcf6b11) !important;
   border-left-style: solid !important;
}

.monaco-editor .dirty-diff-deleted {
   background: linear-gradient(90deg, #ff4d9655, #ff4d9611) !important;
}

/* Terminal styling */
.xterm .xterm-viewport {
   background: #23212d !important;
}

.xterm .xterm-screen canvas {
   filter: saturate(1.05) contrast(1.02) !important;
}

/* Subtle glow on active editor */
// .monaco-workbench .editor-group-container.active {
// 	box-shadow: 0 0 0 1px var(--perfume-accent) inset, 0 0 22px -10px rgba(var(--perfume-accent-glow), 0.6) !important;
// 	border-radius: var(--perfume-radius-sm) !important;
// }

/* Breadcrumb emphasis */
.monaco-breadcrumb-item:hover .label-name {
   color: var(--perfume-accent) !important;
}

.monaco-breadcrumbs-picker > div {
   background: transparent !important;
}

.monaco-scrollable-element,
.file-icon-themable-tree .monaco-list-rows {
   background: transparent !important;
}

/* Compact subtle separators */
.monaco-workbench .sash {
   background-color: #3a374422 !important;
}

.monaco-workbench .sash:hover {
   background-color: var(--perfume-accent) !important;
}

/* Activity bar badge tweaks */
.monaco-workbench .activitybar .badge .badge-content {
   font-weight: 600 !important;
   letter-spacing: 0.3px !important;
}

/* Explorer file hover */
.monaco-list-row:hover:not(.selected) {
   background: #2f2d3a99 !important;
}

/* Selection flourish */
::selection {
   background: #df1b6c66 !important;
   color: #ffffff !important;
}

/* Find widget */
.find-widget,
.simple-find-part {
   // Unset default background to avoid conflicts
   --vscode-editorWidget-background: "";

   @include glass(true);
   @include glassBorder();
}

/* Inline suggestions ghost text clarity */
.monaco-editor .ghost-text-decoration {
   color: #f5eaec44 !important;
   font-style: italic !important;
}

/* Settings editor cards */
.settings-editor .monaco-list-row.focused {
   background: twotoneBackground() !important;
}

/* Outline & symbol tree hover */
.pane-body .monaco-list-row:hover:not(.selected) {
   background: #2f2d3a !important;
}

/* Decorative subtle gradient behind full workbench */
body > .monaco-workbench {
   background: radial-gradient(
      circle at 20% 20%,
      #2f2d3a 0%,
      #23212d 55%,
      #1f1d27 100%
   ) !important;
}

/* Code lens subtle color */
.monaco-editor .codelens-decoration {
   color: #f5eaec55 !important;
}

/* Problems panel row focus */
.markers-panel .monaco-list-row.focused {
   background: twotoneBackground() !important;
}

/* Transparent drag image fixes */
.drag-image {
   background: #2a2834dd !important;
   border: 1px solid var(--perfume-border) !important;
}

/* Gutter Number */
.monaco-editor .line-numbers {
   text-shadow: 0 0 0 #ffffff00;
   transition: text-shadow 1s ease;
}
.monaco-editor .line-numbers.active-line-number {
   @include textGlow(var(--perfume-accent), 50%);
}

/* Gutter's breakpoint icon */
html body .monaco-editor .glyph-margin-widgets,
.monaco-workbench .debug-breakpoints,
.monaco-workbench .disassembly-view,
.monaco-editor .contentWidgets {
   .codicon.codicon-debug-breakpoint,
   .codicon.codicon-debug-breakpoint-function,
   .codicon.codicon-debug-breakpoint-conditional,
   .codicon.codicon-debug-breakpoint-data,
   .codicon.codicon-debug-breakpoint-log,
   .codicon.codicon-debug-breakpoint-unsupported,
   .codicon.codicon-debug-hint:not([class*="codicon-debug-breakpoint"]):not(
         [class*="codicon-debug-stackframe"]
      ),
   .codicon.codicon-debug-breakpoint.codicon.codicon-debug-stackframe-focused::after,
   .codicon.codicon-debug-breakpoint.codicon.codicon-debug-stackframe::after {
      color: sassColor.mix(color.$generic-red, white, 95%) !important;
      @include textGlow(color.$generic-red, 64%);
   }
}
/* Notifications */
.notifications-toasts .monaco-list-row,
.notifications-toasts .monaco-list-rows,
.notifications-toasts .monaco-list-container {
   background: transparent !important;
}

.notifications-toasts .monaco-list-row .notification-list-item {
   @include glassBorder(var(--perfume-border), var(--perfume-radius-md));
}

.notifications-toasts .monaco-list-row:hover .notification-list-item {
   border-color: var(--perfume-accent) !important;
}
/* Border radius for Notifications */
.monaco-workbench>.notifications-toasts .notifications-list-container, .monaco-workbench>.notifications-toasts .notification-toast-container>.notification-toast, .monaco-workbench>.notifications-toasts .notification-toast-container>.notification-toast .monaco-scrollable-element, .monaco-workbench>.notifications-toasts .notification-toast-container>.notification-toast .monaco-list:not(.element-focused):focus:before, .monaco-workbench>.notifications-toasts .notification-toast-container>.notification-toast .monaco-list-row {
   border-radius: var(--perfume-radius-md) !important;
}
